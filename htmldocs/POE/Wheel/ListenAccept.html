<HTML>
<HEAD>
<TITLE><A HREF=/docs/POE/Wheel/ListenAccept.html>POE::Wheel::ListenAccept</A> - accept connections from regular listening sockets</TITLE>
<LINK REV="made" HREF="mailto:">
</HEAD>

<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%"><TR><TD WIDTH="30">
<img HSPACE="0" VSPACE="0" border="0" src="/images/L-circle.jpg" align="left" alt="" width="30" height="60">
</TD><TD ALIGN="Center" WIDTH=100% BGCOLOR="#000000">
<STRONG><font color="#FFFFFF" size="5"><A HREF=/docs/POE/Wheel/ListenAccept.html>POE::Wheel::ListenAccept</A> - accept connections from regular listening sockets</font></STRONG></TD><TD>
<img HSPACE="0" VSPACE="0" border="0" src="/images/R-circle.jpg" align="right" alt="" width="30" height="60">
</TD></TR></TABLE>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#description">DESCRIPTION</A></LI>
	<LI><A HREF="#public methods">PUBLIC METHODS</A></LI>
	<LI><A HREF="#event types and their parameters">EVENT TYPES AND THEIR PARAMETERS</A></LI>
	<LI><A HREF="#see also">SEE ALSO</A></LI>
	<LI><A HREF="#bugs">BUGS</A></LI>
	<LI><A HREF="#authors & copyrights">AUTHORS &amp; COPYRIGHTS</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P><A HREF=/docs/POE/Wheel/ListenAccept.html>POE::Wheel::ListenAccept</A> - accept connections from regular listening sockets</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<PRE>
  $wheel = <A HREF=/docs/POE/Wheel/ListenAccept.html>POE::Wheel::ListenAccept</A>-&gt;new(
    Handle      =&gt; $socket_handle,      # Listening socket
    AcceptState =&gt; $accept_state_name,  # Success state
    ErrorState  =&gt; $error_state_name,   # Failure state
  );</PRE>
<PRE>
  $wheel-&gt;event( AcceptState =&gt; $new_state_name ); # Add/change state
  $wheel-&gt;event( ErrorState  =&gt; undef );           # Remove state</PRE>
<P>
<HR>
<H1><A NAME="description">DESCRIPTION</A></H1>
<P>ListenAccept listens on an already established socket and accepts
remote connections from it as they arrive.  Sockets it listens on can
come from anything that makes filehandles.  This includes <CODE>socket()</CODE>
calls and IO::Socket::* instances.</P>
<P>The ListenAccept wheel generates events for successful and failed
connections.  EAGAIN is handled internally, so sessions needn't worry
about it.</P>
<P>This wheel neither needs nor includes a <CODE>put()</CODE> method.</P>
<P>
<HR>
<H1><A NAME="public methods">PUBLIC METHODS</A></H1>
<DL>
<DT><STRONG><A NAME="item_event_EVENT_TYPE_%3D%3E_EVENT_NAME%2C_%2E%2E%2E">event EVENT_TYPE =&gt; EVENT_NAME, ...</A></STRONG><BR>
<DD>
<CODE>event()</CODE> is covered in the <A HREF=/docs/POE/Wheel.html>POE::Wheel</A> manpage.
<P>ListenAccept's event types are <A HREF="#item_AcceptState"><CODE>AcceptState</CODE></A> and <A HREF="#item_ErrorState"><CODE>ErrorState</CODE></A>.</P>
<P></P>
<DT><STRONG><A NAME="item_ID">ID</A></STRONG><BR>
<DD>
The ID method returns a ListenAccept wheel's unique ID.  This ID will
be included in every event the wheel generates, and it can be used to
match events with the wheels which generated them.
<P></P></DL>
<P>
<HR>
<H1><A NAME="event types and their parameters">EVENT TYPES AND THEIR PARAMETERS</A></H1>
<P>These are the event types this wheel emits and the parameters which
are included with each.</P>
<DL>
<DT><STRONG><A NAME="item_AcceptState">AcceptState</A></STRONG><BR>
<DD>
The AcceptState event is generated whenever a new connection has been
successfully accepted.  AcceptState's event is accompanied by three
parameters: <CODE>ARG0</CODE> contains the accepted socket handle.  <CODE>ARG1</CODE>
contains the <CODE>accept()</CODE> call's return value, which often is the address
of the other end of the socket.  <CODE>ARG2</CODE> contains the wheel's unique
ID.
<P>A sample AcceptState event handler:</P>
<PRE>
  sub accept_state {
    my ($accepted_handle, $remote_address, $wheel_id) = @_[ARG0..ARG2];</PRE>
<PRE>
    # The remote address is always good here.
    my ($port, $packed_ip) = sockaddr_in($remote_address);
    my $dotted_quad = inet_ntoa($packed_ip);</PRE>
<PRE>
    print( &quot;Wheel $wheel_id accepted a connection from &quot;,
           &quot;$dotted_quad port $port.\n&quot;
         );</PRE>
<PRE>
    # Spawn off a session to interact with the socket.
    &amp;create_server_session($handle);
  }</PRE>
<P></P>
<DT><STRONG><A NAME="item_ErrorState">ErrorState</A></STRONG><BR>
<DD>
The ErrorState event is generated whenever a new connection could not
be successfully accepted.  Its event is accompanied by four
parameters.
<P><CODE>ARG0</CODE> contains the name of the operation that failed.  This usually
is 'accept'.  Note: This is not necessarily a function name.</P>
<P><CODE>ARG1</CODE> and <CODE>ARG2</CODE> hold numeric and string values for <CODE>$!</CODE>,
respectively.  Note: ListenAccept knows how to handle EAGAIN, so it
will never return that error.</P>
<P><CODE>ARG3</CODE> contains the wheel's unique ID.</P>
<P>A sample ErrorState event handler:</P>
<PRE>
  sub error_state {
    my ($operation, $errnum, $errstr, $wheel_id) = @_[ARG0..ARG3];
    warn &quot;Wheel $wheel_id generated $operation error $errnum: $errstr\n&quot;;
  }</PRE>
<P></P></DL>
<P>
<HR>
<H1><A NAME="see also">SEE ALSO</A></H1>
<P><A HREF=/docs/POE/Wheel.html>POE::Wheel</A>.</P>
<P>The <A HREF=/docs/POE.html#see also>SEE ALSO section in <EM>POE</EM></A> contains a table of contents covering
the entire POE distribution.</P>
<P>
<HR>
<H1><A NAME="bugs">BUGS</A></H1>
<P>Oh, probably some.</P>
<P>
<HR>
<H1><A NAME="authors & copyrights">AUTHORS &amp; COPYRIGHTS</A></H1>
<P>Please <A HREF=/docs/POE.html>see <EM>POE</EM></A> for more information about authors and contributors.</P>

</BODY>

</HTML>
